"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6831],{91631:function(se,L,t){t.r(L);var F=t(97857),f=t.n(F),Z=t(5574),P=t.n(Z),x=t(15009),u=t.n(x),B=t(99289),n=t.n(B),v=t(67294),d=t(76772),i=t(2453),g=t(83622),K=t(17788),R=t(6110),w=t(65385),O=t(48689),$=t(24969),C=t(11475),z=t(71965),M=t(37563),G=t(92982),N=t(94162),V=t(25464),Y=t(33867),s=t(85893),H=function(){var e=n()(u()().mark(function a(m,r){var h,p,T;return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(h=i.ZP.loading("\u6B63\u5728\u53D6\u6D88\u6388\u6743"),r){l.next=3;break}return l.abrupt("return",!0);case 3:return l.prev=3,p=r.map(function(W){return W.userId}).join(","),l.next=7,(0,M.LA)({roleId:m,userIds:p});case 7:return T=l.sent,h(),T.code===200?i.ZP.success("\u53D6\u6D88\u6388\u6743\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"):i.ZP.error(T.msg),l.abrupt("return",!0);case 13:return l.prev=13,l.t0=l.catch(3),h(),i.ZP.error("\u53D6\u6D88\u6388\u6743\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),l.abrupt("return",!1);case 18:case"end":return l.stop()}},a,null,[[3,13]])}));return function(m,r){return e.apply(this,arguments)}}(),k=function(){var e=n()(u()().mark(function a(m,r){var h,p;return u()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return h=i.ZP.loading("\u6B63\u5728\u53D6\u6D88\u6388\u6743"),c.prev=1,c.next=4,(0,M.CE)({userId:r,roleId:m});case 4:return p=c.sent,h(),p.code===200?i.ZP.success("\u53D6\u6D88\u6388\u6743\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"):i.ZP.error(p.msg),c.abrupt("return",!0);case 10:return c.prev=10,c.t0=c.catch(1),h(),i.ZP.error("\u53D6\u6D88\u6388\u6743\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),c.abrupt("return",!1);case 15:case"end":return c.stop()}},a,null,[[1,10]])}));return function(m,r){return e.apply(this,arguments)}}(),J=function(){var a=(0,v.useState)(!1),m=P()(a,2),r=m[0],h=m[1],p=(0,v.useRef)(),T=(0,v.useState)([]),c=P()(T,2),l=c[0],W=c[1],ne=(0,v.useState)([]),q=P()(ne,2),ee=q[0],ae=q[1],X=(0,d.useAccess)(),ue=(0,d.useIntl)(),te=(0,d.useParams)();te.id===void 0&&d.history.back();var I=te.id||"0";(0,v.useEffect)(function(){(0,G.pX)("sys_normal_disable").then(function(E){ae(E)})},[]);var oe=[{title:(0,s.jsx)(d.FormattedMessage,{id:"system.user.user_id",defaultMessage:"\u7528\u6237\u7F16\u53F7"}),dataIndex:"deptId",valueType:"text"},{title:(0,s.jsx)(d.FormattedMessage,{id:"system.user.user_name",defaultMessage:"\u7528\u6237\u8D26\u53F7"}),dataIndex:"userName",valueType:"text"},{title:(0,s.jsx)(d.FormattedMessage,{id:"system.user.nick_name",defaultMessage:"\u7528\u6237\u6635\u79F0"}),dataIndex:"nickName",valueType:"text"},{title:(0,s.jsx)(d.FormattedMessage,{id:"system.user.phonenumber",defaultMessage:"\u624B\u673A\u53F7\u7801"}),dataIndex:"phonenumber",valueType:"text"},{title:(0,s.jsx)(d.FormattedMessage,{id:"system.role.create_time",defaultMessage:"\u521B\u5EFA\u65F6\u95F4"}),dataIndex:"createTime",valueType:"dateRange",render:function(D,o){return(0,s.jsxs)("span",{children:[o.createTime.toString()," "]})},hideInSearch:!0},{title:(0,s.jsx)(d.FormattedMessage,{id:"system.user.status",defaultMessage:"\u5E10\u53F7\u72B6\u6001"}),dataIndex:"status",valueType:"select",valueEnum:ee,render:function(D,o){return(0,s.jsx)(N.Z,{enums:ee,value:o.status})}},{title:(0,s.jsx)(d.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",width:"60px",valueType:"option",render:function(D,o){return[(0,s.jsx)(g.ZP,{type:"link",size:"small",danger:!0,icon:(0,s.jsx)(O.Z,{}),hidden:!X.hasPerms("system:role:remove"),onClick:n()(u()().mark(function _(){return u()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:K.Z.confirm({title:"\u5220\u9664",content:"\u786E\u8BA4\u8981\u53D6\u6D88\u8BE5\u7528\u6237"+o.userName+'"\u89D2\u8272\u6388\u6743\u5417\uFF1F',okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var S=n()(u()().mark(function A(){var Q;return u()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,k(I,o.userId);case 2:Q=b.sent,Q&&p.current&&p.current.reload();case 4:case"end":return b.stop()}},A)}));function y(){return S.apply(this,arguments)}return y}()});case 1:case"end":return U.stop()}},_)})),children:"\u53D6\u6D88\u6388\u6743"},"remove")]}}];return(0,s.jsxs)(R._z,{children:[(0,s.jsx)("div",{style:{width:"100%",float:"right"},children:(0,s.jsx)(w.Z,{headerTitle:ue.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u4FE1\u606F"}),actionRef:p,rowKey:"userId",search:{labelWidth:120},toolBarRender:function(){return[(0,s.jsxs)(g.ZP,{type:"primary",hidden:!X.hasPerms("system:role:add"),onClick:n()(u()().mark(function D(){return u()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:h(!0);case 1:case"end":return _.stop()}},D)})),children:[(0,s.jsx)($.Z,{})," ",(0,s.jsx)(d.FormattedMessage,{id:"system.role.auth.addUser",defaultMessage:"\u6DFB\u52A0\u7528\u6237"})]},"add"),(0,s.jsxs)(g.ZP,{type:"primary",danger:!0,hidden:(l==null?void 0:l.length)===0||!X.hasPerms("system:role:remove"),onClick:n()(u()().mark(function D(){return u()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:K.Z.confirm({title:"\u662F\u5426\u786E\u8BA4\u5220\u9664\u6240\u9009\u6570\u636E\u9879?",icon:(0,s.jsx)(C.Z,{}),content:"\u8BF7\u8C28\u614E\u64CD\u4F5C",onOk:function(){return n()(u()().mark(function U(){var S,y,A;return u()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,H(I,l);case 2:S=j.sent,S&&(W([]),(y=p.current)===null||y===void 0||(A=y.reloadAndRest)===null||A===void 0||A.call(y));case 4:case"end":return j.stop()}},U)}))()},onCancel:function(){}});case 1:case"end":return _.stop()}},D)})),children:[(0,s.jsx)(O.Z,{}),(0,s.jsx)(d.FormattedMessage,{id:"system.role.auth.cancelAll",defaultMessage:"\u6279\u91CF\u53D6\u6D88\u6388\u6743"})]},"remove"),(0,s.jsxs)(g.ZP,{type:"primary",onClick:n()(u()().mark(function D(){return u()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:d.history.back();case 1:case"end":return _.stop()}},D)})),children:[(0,s.jsx)(z.Z,{}),(0,s.jsx)(d.FormattedMessage,{id:"pages.goback",defaultMessage:"\u8FD4\u56DE"})]},"back")]},request:function(D){return(0,M.iH)(f()(f()({},D),{},{roleId:I})).then(function(o){var _={data:o.rows,total:o.total,success:!0};return _})},columns:oe,rowSelection:{onChange:function(D,o){W(o)}}},"userList")}),(0,s.jsx)(V.default,{open:r,onSubmit:function(D){var o=D.join(",");if(o===""){i.ZP.warning("\u8BF7\u9009\u62E9\u8981\u5206\u914D\u7684\u7528\u6237");return}(0,M.dY)({roleId:I,userIds:o}).then(function(_){_.code===Y.iK.SUCCESS?(i.ZP.success("\u66F4\u65B0\u6210\u529F\uFF01"),p.current&&p.current.reload()):i.ZP.warning(_.msg)}),h(!1)},onCancel:function(){h(!1)},params:{roleId:I},request:function(D){return(0,M.p7)(f()({},D)).then(function(o){var _={data:o.rows,total:o.rows.length,success:!0};return _})}})]})};L.default=J},37563:function(se,L,t){t.d(L,{CE:function(){return s},JV:function(){return d},LA:function(){return H},Lp:function(){return z},Vl:function(){return J},_d:function(){return K},cY:function(){return g},dY:function(){return k},iH:function(){return V},l5:function(){return $},mj:function(){return M},p7:function(){return Y},sp:function(){return N},tm:function(){return G},ul:function(){return w}});var F=t(15009),f=t.n(F),Z=t(97857),P=t.n(Z),x=t(99289),u=t.n(x),B=t(33867),n=t(76772),v=t(30964);function d(e){return i.apply(this,arguments)}function i(){return i=u()(f()().mark(function e(a){return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,n.request)("/api/system/role/list",{method:"GET",headers:{"Content-Type":B.zc.FORM_URLENCODED},params:P()(P()({},a),{},{pageNum:(a==null?void 0:a.current)||1,pageSize:(a==null?void 0:a.pageSize)||10})}));case 1:case"end":return r.stop()}},e)})),i.apply(this,arguments)}function g(e){return(0,n.request)("/api/system/role/".concat(e),{method:"GET"})}function K(e){return R.apply(this,arguments)}function R(){return R=u()(f()().mark(function e(a){return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,n.request)("/api/system/role",{method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8"},data:a}));case 1:case"end":return r.stop()}},e)})),R.apply(this,arguments)}function w(e){return O.apply(this,arguments)}function O(){return O=u()(f()().mark(function e(a){return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,n.request)("/api/system/role",{method:"PUT",headers:{"Content-Type":"application/json;charset=UTF-8"},data:a}));case 1:case"end":return r.stop()}},e)})),O.apply(this,arguments)}function $(e){return C.apply(this,arguments)}function C(){return C=u()(f()().mark(function e(a){return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,n.request)("/api/system/role/".concat(a),{method:"DELETE"}));case 1:case"end":return r.stop()}},e)})),C.apply(this,arguments)}function z(e){return(0,v.su)("/api/system/role/export",{params:e},"role_".concat(new Date().getTime(),".xlsx"))}function M(e){return(0,n.request)("/api/system/menu/roleMenuTreeselect/".concat(e),{method:"get"})}function G(e){return(0,n.request)("/api/system/role/dataScope",{method:"put",data:e})}function N(e,a){var m={roleId:e,status:a};return(0,n.request)("/api/system/role/changeStatus",{method:"put",data:m})}function V(e){return(0,n.request)("/api/system/role/authUser/allocatedList",{method:"get",params:e})}function Y(e){return(0,n.request)("/api/system/role/authUser/unallocatedList",{method:"get",params:e})}function s(e){return(0,n.request)("/api/system/role/authUser/cancel",{method:"put",data:e})}function H(e){return(0,n.request)("/api/system/role/authUser/cancelAll",{method:"put",params:e})}function k(e){return(0,n.request)("/api/system/role/authUser/selectAll",{method:"put",params:e,headers:{"Content-Type":B.zc.FORM_URLENCODED}})}function J(e){return(0,n.request)("/api/system/role/deptTree/"+e,{method:"get"})}}}]);
