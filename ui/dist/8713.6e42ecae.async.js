"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[8713,5808,2531],{42734:function(q,T,n){n.r(T);var w=n(67294),y=n(76772),L=n(17788),r=n(92398),U=n(53951),u=n(65899),_=n(85893),f=function(v){var B=(0,y.useIntl)(),i=[],p=Object.keys(v.data);return p.forEach(function(c){i.push({key:c+"1",label:c.substring(c.lastIndexOf("/")+1,c.indexOf(".vm")),children:(0,_.jsx)(U.default,{className:"java",children:v.data[c]})})}),(0,w.useEffect)(function(){},[]),(0,_.jsx)(L.Z,{width:900,title:B.formatMessage({id:"gen.preview",defaultMessage:"\u9884\u89C8"}),open:v.open,destroyOnClose:!0,footer:!1,onOk:function(){v.onHide()},onCancel:function(){v.onHide()},children:(0,_.jsx)(r.Z,{defaultActiveKey:"1",items:i})})};T.default=f},89401:function(q,T,n){n.r(T);var w=n(97857),y=n.n(w),L=n(5574),r=n.n(L),U=n(15009),u=n.n(U),_=n(99289),f=n.n(_),x=n(23430),v=n(24969),B=n(26058),i=n(2453),p=n(83622),c=n(17788),z=n(4393),K=n(85265),O=n(67294),h=n(76772),H=n(42734),D=n(12531),V=n(65385),W=n(2236),Y=n(98097),s=n(85893),J=B.Z.Content,S=function(){var I=f()(u()().mark(function E(t){var a;return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.ZP.loading("\u6B63\u5728\u5220\u9664"),t){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,(0,D.removeData)({ids:t.map(function(l){return l.tableId})});case 6:return a(),i.ZP.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),a(),i.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),e.abrupt("return",!1);case 16:case"end":return e.stop()}},E,null,[[3,11]])}));return function(t){return I.apply(this,arguments)}}(),Q=function(){var I=f()(u()().mark(function E(t){var a,d;return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=i.ZP.loading("\u6B63\u5728\u5220\u9664"),t){l.next=3;break}return l.abrupt("return",!0);case 3:return l.prev=3,d=[t.tableId],l.next=7,(0,D.removeData)({ids:d});case 7:return a(),i.ZP.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),l.abrupt("return",!0);case 12:return l.prev=12,l.t0=l.catch(3),a(),i.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),l.abrupt("return",!1);case 17:case"end":return l.stop()}},E,null,[[3,12]])}));return function(t){return I.apply(this,arguments)}}(),F=function(){var E=(0,O.useRef)(),t=(0,O.useState)(!1),a=r()(t,2),d=a[0],e=a[1],l=(0,O.useState)(!1),ee=r()(l,2),le=ee[0],ne=ee[1],ie=(0,O.useState)(!1),te=r()(ie,2),de=te[0],_e=te[1],k=(0,O.useRef)(),ce=(0,O.useState)(),ae=r()(ce,2),g=ae[0],re=ae[1],De=(0,O.useState)([]),se=r()(De,2),b=se[0],ue=se[1],j=(0,h.useAccess)(),oe=[{title:"\u7F16\u53F7",dataIndex:"tableId",tip:"\u7F16\u53F7",render:function(M,o){return(0,s.jsx)("a",{onClick:function(){re(o),e(!0)},children:M})}},{title:"\u8868\u540D",dataIndex:"tableName",valueType:"textarea"},{title:"\u8868\u63CF\u8FF0",dataIndex:"tableComment",hideInForm:!0,hideInSearch:!0},{title:"\u5B9E\u4F53",dataIndex:"className",valueType:"textarea"},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",valueType:"textarea",hideInSearch:!0},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updateTime",valueType:"textarea",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"option",width:"220px",valueType:"option",render:function(M,o){return[(0,s.jsx)(p.ZP,{type:"link",size:"small",hidden:!j.hasPerms("tool:gen:edit"),onClick:function(){(0,D.previewCode)(o.tableId).then(function(C){C.code===200?(_e(C.data),ne(!0)):i.ZP.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25")})},children:"\u9884\u89C8"},"preview"),(0,s.jsx)(p.ZP,{type:"link",size:"small",hidden:!j.hasPerms("tool:gen:edit"),onClick:function(){h.history.push("/tool/gen/edit?id=".concat(o.tableId))},children:"\u7F16\u8F91"},"config"),(0,s.jsx)(p.ZP,{type:"link",size:"small",danger:!0,hidden:!j.hasPerms("tool:gen:del"),onClick:f()(u()().mark(function m(){return u()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:c.Z.confirm({title:"\u5220\u9664\u4EFB\u52A1",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u4EFB\u52A1\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var N=f()(u()().mark(function G(){var X;return u()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,Q(o);case 2:X=$.sent,X&&k.current&&k.current.reload();case 4:case"end":return $.stop()}},G)}));function R(){return N.apply(this,arguments)}return R}()});case 1:case"end":return Z.stop()}},m)})),children:"\u5220\u9664"},"delete"),(0,s.jsx)(p.ZP,{type:"link",size:"small",hidden:!j.hasPerms("tool:gen:edit"),onClick:function(){(0,D.syncDbInfo)(o.tableName).then(function(C){C.code===200?i.ZP.success("\u540C\u6B65\u6210\u529F"):i.ZP.error("\u540C\u6B65\u5931\u8D25")})},children:"\u540C\u6B65"},"sync"),(0,s.jsx)(p.ZP,{type:"link",size:"small",hidden:!j.hasPerms("tool:gen:edit"),onClick:function(){o.genType==="1"?(0,D.genCode)(o.tableName).then(function(C){C.code===200?i.ZP.success("\u6210\u529F\u751F\u6210\u5230\u81EA\u5B9A\u4E49\u8DEF\u5F84\uFF1A".concat(o.genPath)):i.ZP.error(C.msg)}):(0,D.batchGenCode)(o.tableName)},children:"\u751F\u6210\u4EE3\u7801"},"gencode")]}}];return(0,s.jsx)(J,{children:(0,s.jsxs)(z.Z,{bordered:!1,children:[(0,s.jsx)(V.Z,{headerTitle:"\u4EE3\u7801\u751F\u6210\u4FE1\u606F",actionRef:k,formRef:E,rowKey:"tableId",search:{labelWidth:120},toolBarRender:function(){return[(0,s.jsxs)(p.ZP,{type:"primary",hidden:!j.hasPerms("tool:gen:edit"),onClick:function(){if(b.length===0){i.ZP.error("\u8BF7\u9009\u62E9\u8981\u751F\u6210\u7684\u6570\u636E");return}var o=b.map(function(m){return m.tableName});b[0].genType==="1"?(0,D.genCode)(o.join(",")).then(function(m){m.code===200?i.ZP.success("\u6210\u529F\u751F\u6210\u5230\u81EA\u5B9A\u4E49\u8DEF\u5F84\uFF1A".concat(b[0].genPath)):i.ZP.error(m.msg)}):(0,D.batchGenCode)(o.join(","))},children:[(0,s.jsx)(x.Z,{})," ",(0,s.jsx)(h.FormattedMessage,{id:"gen.gencode",defaultMessage:"\u751F\u6210"})]},"gen"),(0,s.jsxs)(p.ZP,{type:"primary",hidden:!j.hasPerms("tool:gen:add"),onClick:function(){h.history.push("/tool/gen/import")},children:[(0,s.jsx)(v.Z,{})," ",(0,s.jsx)(h.FormattedMessage,{id:"gen.import",defaultMessage:"\u5BFC\u5165"})]},"import")]},request:function(M){return(0,D.getGenCodeList)(y()({},M)).then(function(o){return{data:o.rows,total:o.rows.length,success:!0}})},columns:oe,rowSelection:{onChange:function(M,o){ue(o)}}}),(b==null?void 0:b.length)>0&&(0,s.jsx)(W.S,{extra:(0,s.jsxs)("div",{children:[(0,s.jsx)(h.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"\u5DF2\u9009\u62E9"})," ",(0,s.jsx)("a",{style:{fontWeight:600},children:b.length})," ",(0,s.jsx)(h.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"})]}),children:(0,s.jsx)(p.ZP,{hidden:!j.hasPerms("tool:gen:remove"),onClick:f()(u()().mark(function P(){return u()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:c.Z.confirm({title:"\u5220\u9664\u4EFB\u52A1",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u4EFB\u52A1\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var m=f()(u()().mark(function Z(){var N,R,G;return u()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,S(b);case 2:N=A.sent,N&&(ue([]),(R=k.current)===null||R===void 0||(G=R.reloadAndRest)===null||G===void 0||G.call(R));case 4:case"end":return A.stop()}},Z)}));function C(){return m.apply(this,arguments)}return C}()});case 1:case"end":return o.stop()}},P)})),children:(0,s.jsx)(h.FormattedMessage,{id:"pages.searchTable.batchDeletion",defaultMessage:"\u6279\u91CF\u5220\u9664"})},"delete")}),(0,s.jsx)(H.default,{open:le,data:de,onHide:function(){ne(!1)}}),(0,s.jsx)(K.Z,{width:600,open:d,onClose:function(){re(void 0),e(!1)},closable:!1,children:(g==null?void 0:g.tableName)&&(0,s.jsx)(Y.vY,{column:2,title:g==null?void 0:g.tableName,request:f()(u()().mark(function P(){return u()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",{data:g||{}});case 1:case"end":return o.stop()}},P)})),params:{id:g==null?void 0:g.tableName},columns:oe})})]})})};T.default=F},12531:function(q,T,n){n.r(T),n.d(T,{addData:function(){return H},batchGenCode:function(){return Q},genCode:function(){return J},getGenCode:function(){return B},getGenCodeList:function(){return x},importTables:function(){return z},previewCode:function(){return I},queryTableList:function(){return p},removeData:function(){return O},syncDbInfo:function(){return Y},updateData:function(){return V}});var w=n(97857),y=n.n(w),L=n(15009),r=n.n(L),U=n(99289),u=n.n(U),_=n(76772),f=n(30964);function x(t){return v.apply(this,arguments)}function v(){return v=u()(r()().mark(function t(a){var d;return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return d=new URLSearchParams(a).toString(),l.abrupt("return",(0,_.request)("/api/code/gen/list?".concat(d),{data:a,method:"get",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 2:case"end":return l.stop()}},t)})),v.apply(this,arguments)}function B(t){return i.apply(this,arguments)}function i(){return i=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/code/gen/".concat(a),{method:"get",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 1:case"end":return e.stop()}},t)})),i.apply(this,arguments)}function p(t){return c.apply(this,arguments)}function c(){return c=u()(r()().mark(function t(a){var d;return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return d=new URLSearchParams(a).toString(),l.abrupt("return",(0,_.request)("/api/code/gen/db/list?".concat(d),{data:a,method:"get",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 2:case"end":return l.stop()}},t)})),c.apply(this,arguments)}function z(t){return K.apply(this,arguments)}function K(){return K=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/code/gen/importTable?tables=".concat(a),{method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 1:case"end":return e.stop()}},t)})),K.apply(this,arguments)}function O(t){return h.apply(this,arguments)}function h(){return h=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/code/gen/".concat(a.ids),{method:"delete",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 1:case"end":return e.stop()}},t)})),h.apply(this,arguments)}function H(t){return D.apply(this,arguments)}function D(){return D=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/code/gen",{method:"POST",data:y()({},a)}));case 1:case"end":return e.stop()}},t)})),D.apply(this,arguments)}function V(t){return W.apply(this,arguments)}function W(){return W=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/code/gen",{method:"PUT",data:y()({},a)}));case 1:case"end":return e.stop()}},t)})),W.apply(this,arguments)}function Y(t){return s.apply(this,arguments)}function s(){return s=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/code/gen/synchDb/".concat(a),{method:"GET"}));case 1:case"end":return e.stop()}},t)})),s.apply(this,arguments)}function J(t){return S.apply(this,arguments)}function S(){return S=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/code/gen/genCode/".concat(a),{method:"GET"}));case 1:case"end":return e.stop()}},t)})),S.apply(this,arguments)}function Q(t){return F.apply(this,arguments)}function F(){return F=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.p6)("/api/code/gen/batchGenCode?tables=".concat(a)));case 1:case"end":return e.stop()}},t)})),F.apply(this,arguments)}function I(t){return E.apply(this,arguments)}function E(){return E=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/code/gen/preview/".concat(a),{method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 1:case"end":return e.stop()}},t)})),E.apply(this,arguments)}}}]);
