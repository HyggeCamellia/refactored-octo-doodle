"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7694,8906,6656],{37694:function(Z,D,e){e.r(D),e.d(D,{default:function(){return B}});var j=e(5574),m=e.n(j),U=e(67294),h=e(2453),g=e(17788),_=e(71230),c=e(15746),d=e(23799),E=e(83622),M=e(78957),o=e(76772),P=e(9025),x=e(42016),y=e(68906),R={avatarPreview:"avatarPreview___aVJPD"},v=e(88484),r=e(87740),f=e(10149),L=e(24969),I=e(52745),u=e(85893),b=function(O){var i=(0,U.useRef)(null),w=(0,U.useState)(),A=m()(w,2),t=A[0],n=A[1],l=(0,U.useState)(),C=m()(l,2),s=C[0],F=C[1];(0,U.useEffect)(function(){n(O.data)},[O]);var z=(0,o.useIntl)(),N=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;p.getCroppedCanvas().toBlob(function(Y){var K=new FormData;K.append("avatarfile",Y),(0,P.gg)(K).then(function(S){S.code===200?(h.ZP.success(S.msg),O.onFinished(!0)):h.ZP.warning(S.msg)})},"image/png")},G=function(){O.onFinished(!1)},$=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;F(p.getCroppedCanvas().toDataURL())},Q=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;p.rotate(90)},J=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;p.rotate(-90)},V=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;p.zoom(.1)},X=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;p.zoom(-.1)},H=function(a){var p=new FileReader;p.readAsDataURL(a),p.onload=function(){n(p.result)}};return(0,u.jsxs)(g.Z,{width:800,title:z.formatMessage({id:"system.user.modify_avatar",defaultMessage:"\u4FEE\u6539\u5934\u50CF"}),open:O.open,destroyOnClose:!0,onOk:N,onCancel:G,children:[(0,u.jsxs)(_.Z,{gutter:[16,16],children:[(0,u.jsx)(c.Z,{span:12,order:1,children:(0,u.jsx)(x.f,{ref:i,src:t,style:{height:350,width:"100%",marginBottom:"16px"},initialAspectRatio:1,guides:!1,crop:$,zoomable:!0,zoomOnWheel:!0,rotatable:!0})}),(0,u.jsx)(c.Z,{span:12,order:2,children:(0,u.jsx)("div",{className:R.avatarPreview,children:(0,u.jsx)("img",{src:s,style:{height:"100%",width:"100%"}})})})]}),(0,u.jsxs)(_.Z,{gutter:[16,16],children:[(0,u.jsx)(c.Z,{span:6,children:(0,u.jsx)(d.Z,{beforeUpload:H,maxCount:1,children:(0,u.jsxs)(E.ZP,{children:[(0,u.jsx)(v.Z,{}),"\u4E0A\u4F20"]})})}),(0,u.jsx)(c.Z,{children:(0,u.jsxs)(M.Z,{children:[(0,u.jsx)(E.ZP,{icon:(0,u.jsx)(r.Z,{}),onClick:Q}),(0,u.jsx)(E.ZP,{icon:(0,u.jsx)(f.Z,{}),onClick:J}),(0,u.jsx)(E.ZP,{icon:(0,u.jsx)(L.Z,{}),onClick:V}),(0,u.jsx)(E.ZP,{icon:(0,u.jsx)(I.Z,{}),onClick:X})]})})]})]})},B=b},9025:function(Z,D,e){e.d(D,{Lj:function(){return b},Nq:function(){return R},PR:function(){return P},_L:function(){return L},az:function(){return I},cn:function(){return x},gg:function(){return O},kX:function(){return r},lE:function(){return M},tW:function(){return w},wp:function(){return W},x7:function(){return A},xB:function(){return B}});var j=e(15009),m=e.n(j),U=e(97857),h=e.n(U),g=e(99289),_=e.n(g),c=e(31981),d=e(76772),E=e(30964);function M(t,n){return o.apply(this,arguments)}function o(){return o=_()(m()().mark(function t(n,l){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,d.request)("/api/system/user/list",h()({method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8"},params:h()({pageNum:n.current,pageSize:n.pageSize},n)},l||{})));case 1:case"end":return s.stop()}},t)})),o.apply(this,arguments)}function P(t,n){return(0,d.request)("/api/system/user/".concat(t),h()({method:"GET"},n||{}))}function x(t,n){return y.apply(this,arguments)}function y(){return y=_()(m()().mark(function t(n,l){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,d.request)("/api/system/user",h()({method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8"},data:n},l||{})));case 1:case"end":return s.stop()}},t)})),y.apply(this,arguments)}function R(t,n){return v.apply(this,arguments)}function v(){return v=_()(m()().mark(function t(n,l){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,d.request)("/api/system/user",h()({method:"PUT",headers:{"Content-Type":"application/json;charset=UTF-8"},data:n},l||{})));case 1:case"end":return s.stop()}},t)})),v.apply(this,arguments)}function r(t,n){return f.apply(this,arguments)}function f(){return f=_()(m()().mark(function t(n,l){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,d.request)("/api/system/user/".concat(n),h()({method:"DELETE"},l||{})));case 1:case"end":return s.stop()}},t)})),f.apply(this,arguments)}function L(t,n){return(0,E.su)("/api/system/user/export",{params:t},"user_".concat(new Date().getTime(),".xlsx"))}function I(t,n){var l={userId:t,status:n};return(0,d.request)("/api/system/user/changeStatus",{method:"put",data:l})}function u(){return request("/api/system/user/profile",{method:"get"})}function b(t){return(0,d.request)("/api/system/user/profile",{method:"put",data:t})}function B(t,n){var l={userId:t,password:n};return(0,d.request)("/api/system/user/resetPwd",{method:"put",data:l})}function W(t,n){var l={oldPassword:t,newPassword:n};return(0,d.request)("/api/system/user/profile/updatePwd",{method:"put",params:l})}function O(t){return(0,d.request)("/api/system/user/profile/avatar",{method:"post",data:t})}function i(t){return request("/system/user/authRole/"+t,{method:"get"})}function w(t){return(0,d.request)("/system/user/authRole",{method:"put",params:t})}function A(t){return new Promise(function(n){(0,d.request)("/api/system/user/deptTree",{method:"get",params:t}).then(function(l){if(l&&l.code===200){var C=(0,c.lt)(l.data);n(C)}else n([])})})}},31981:function(Z,D,e){e.d(D,{C2:function(){return m},lt:function(){return h}});var j=e(87735);function m(g,_,c,d,E,M){var o={id:_||"id",name:c||"name",parentId:d||"parentId",parentName:E||"parentName",childrenList:M||"children"},P=[],x=[],y=[];g.forEach(function(v){var r=v,f=r[o.parentId];P[f]||(P[f]=[]),r.key=r[o.id],r.title=r[o.name],r.value=r[o.id],r[o.childrenList]=null,x[r[o.id]]=r,P[f].push(r)}),g.forEach(function(v){var r=v,f=r[o.parentId];x[f]||(r[o.parentName]="",y.push(r))});function R(v){var r=v;P[r[o.id]]&&(r[o.childrenList]||(r[o.childrenList]=[]),r[o.childrenList]=P[r[o.id]]),r[o.childrenList]&&r[o.childrenList].forEach(function(f){var L=f;L[o.parentName]=r[o.name],R(L)})}return y.forEach(function(v){R(v)}),y}var U=function(){return parse(window.location.href.split("?")[1])};function h(g){var _=g.map(function(c){var d={id:c.id,title:c.label,key:"".concat(c.id),value:c.id};return c.children&&(d.children=h(c.children)),d});return _}},68906:function(Z,D,e){e.r(D)},15746:function(Z,D,e){var j=e(21584);D.Z=j.Z},71230:function(Z,D,e){var j=e(17621);D.Z=j.Z}}]);
